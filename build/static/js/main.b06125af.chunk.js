(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],{25:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(14),s=n.n(i),o=(n(25),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),i(e),s(e)}))}),r=n(2),l=n(3),u=n.p+"static/media/logo.abb64ac9.svg",p=n(0);var d=function(e){var t=Object(l.g)();function n(t){return t.email?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("p",{className:"header__email",children:e.email}),Object(p.jsx)("button",{className:"header__btn",onClick:e.onSignOut,children:"\u0412\u044b\u0439\u0442\u0438"})]}):Object(p.jsx)(p.Fragment,{children:" "})}return Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("img",{className:"header__logo",src:u,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430"}),Object(p.jsxs)("div",{className:"header__field",children:[Object(p.jsx)("button",{className:"header__btn",onClick:function(){t.push(e.link)},children:e.title}),Object(p.jsx)(n,{email:e.email})]})]})},j=n(19),h=c.a.createContext();var m=function(e){var t,n=c.a.useContext(h),a=e.isOwn._id===n._id,i="".concat(a?"place__del":"nothing"),s=e.likes.some((function(e){return e._id===n._id})),o="".concat(s?"place__like place-like":"place__like");return Object(p.jsxs)("article",{className:"place",children:[Object(p.jsx)("img",{className:"place__img",src:e.img,onClick:function(){e.onCardClick(e)},alt:(t=e.name,'\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430: "'+t+'"')}),Object(p.jsx)("button",{onClick:function(){e.onCardDelete(e)},className:i,type:"button"}),Object(p.jsxs)("div",{className:"place__option",children:[Object(p.jsx)("h2",{className:"place__title",children:e.name}),Object(p.jsxs)("div",{className:"place__like-container",children:[Object(p.jsx)("button",{onClick:function(){e.onCardLike(e)},className:o,type:"button"}),Object(p.jsx)("p",{className:"place__num",children:e.likes.length})]})]})]})};var b=function(e){var t=c.a.useContext(h);return Object(p.jsxs)("main",{children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsxs)("div",{className:"profile__container",children:[Object(p.jsx)("img",{className:"profile__img",alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",src:t.avatar}),Object(p.jsx)("div",{onClick:e.onEditAvatar,className:"profile__overlay",children:Object(p.jsx)("button",{className:"profile__edit",type:"button"})})]}),Object(p.jsxs)("div",{className:"profile-char",children:[Object(p.jsxs)("div",{className:"profile-char__discr",children:[Object(p.jsxs)("div",{className:"profile-char__info",children:[Object(p.jsx)("h1",{id:"text-up",className:"profile-char__title",children:t.name}),Object(p.jsx)("button",{className:"profile-char__edit",type:"button",onClick:e.onEditProfile})]}),Object(p.jsx)("p",{id:"text-dw",className:"profile-char__subtitle",children:t.about})]}),Object(p.jsx)("button",{className:"profile-char__add",type:"button",onClick:e.onAddPlace})]})]}),Object(p.jsx)("section",{className:"places",children:e.cards.map((function(t){return Object(p.jsx)(m,{name:t.name,img:t.link,likes:t.likes,id:t._id,onCardClick:e.onCardClick,isOwn:t.owner,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})};var _=function(e){var t,n=e.card,a=e.onClose;return Object(p.jsx)("div",{id:"popup-img",className:n.name?"popup-img popup popup_open":"popup-img popup",children:Object(p.jsxs)("div",{className:"popup-img__container",children:[Object(p.jsx)("img",{className:"popup-img__img",alt:(t=n.name,'\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430: "'+t+'"'),src:n.img}),Object(p.jsx)("p",{className:"popup-img__title",children:n.name}),Object(p.jsx)("button",{id:"popup-img__close",className:"popup__close",onClick:a})]})})},f=n(17),O=n(18),x=new(function(){function e(t){Object(f.a)(this,e),this._token=t.token,this._cohortId=t.cohortId,this._url=t.url,this._me="/v1/"+this._cohortId+"/users/me",this._ava=this._me+"/avatar",this._cards="/v1/"+this._cohortId+"/cards",this._likes=this._url+this._cards+"/likes/"}return Object(O.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._url+this._me,{headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"getCardsFromServer",value:function(){var e=this;return fetch(this._url+this._cards,{headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"changeAvatar",value:function(e){var t=this;return fetch(this._url+this._ava,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.link})}).then((function(e){return t._getResponseData(e)}))}},{key:"loadProfile",value:function(e){var t=this;return fetch(this._url+this._me,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return t._getResponseData(e)}))}},{key:"loadNewCard",value:function(e){var t=this;return fetch(this._url+this._cards,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._getResponseData(e)}))}},{key:"delCard",value:function(e){var t=this;return fetch(this._url+this._cards+"/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){var n=this;return fetch(this._likes+e,{method:t,headers:{authorization:this._token}}).then((function(e){return n._getResponseData(e)}))}}]),e}())({token:"54e47a58-a3be-4854-bdb0-d150680efc4c",cohortId:"cohort-24",myId:"34f519f4db31bcdefd2e9e7c",url:"https://mesto.nomoreparties.co"}),g=n.p+"static/media/load.0bbdeb44.gif";var v=function(e){return Object(p.jsx)("div",{id:"popup-".concat(e.name),className:e.isOpen?"popup popup_open":"popup",children:Object(p.jsxs)("div",{className:"popup-".concat(e.name,"__container popup__container"),children:[Object(p.jsx)("button",{id:"popup-".concat(e.name,"__close"),onClick:e.onClose,className:"popup__close",type:"button"}),Object(p.jsx)("p",{className:"popup-".concat(e.name,"__title"),children:"".concat(e.textTitle)}),Object(p.jsxs)("form",{onSubmit:e.onSubmit,name:"".concat(e.name),className:"popup-".concat(e.name,"__form popup__form"),children:[e.children,Object(p.jsx)("button",{id:"popup-".concat(e.name,"__save"),className:"popup__save",type:"submit",children:"".concat(e.textButton)})]})]})})};var k=function(e){var t=c.a.useContext(h),n=c.a.useState(t.name),a=Object(r.a)(n,2),i=a[0],s=a[1],o=c.a.useState(t.about),l=Object(r.a)(o,2),u=l[0],d=l[1];return c.a.useEffect((function(){s(t.name),d(t.about)}),[t,e.isOpen]),Object(p.jsxs)(v,{name:"edit",textTitle:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",textButton:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i,about:u})},children:[Object(p.jsx)("input",{value:i,onChange:function(e){s(e.target.value)},id:"input-profile-title",className:"popup__input",name:"name",type:"text",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40"}),Object(p.jsx)("span",{id:"input-profile-title-error",className:"popup__error"}),Object(p.jsx)("input",{value:u,onChange:function(e){d(e.target.value)},id:"input-profile-subtitle",className:"popup__input",name:"about",type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200"}),Object(p.jsx)("span",{id:"input-profile-subtitle-error",className:"popup__error"})]})};var N=function(e){var t=c.a.useRef();return Object(p.jsxs)(v,{onSubmit:function(n){n.preventDefault(),e.onUpdateAvarar({link:t.current.value})},name:"avatar",isOpen:e.isOpen,textTitle:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",textButton:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onClose:e.onClose,children:[Object(p.jsx)("input",{ref:t,id:"popup-avatar-link",className:"popup__input",name:"link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(p.jsx)("span",{id:"popup-avatar-link-error",className:"popup__error"})]})};var C=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],i=n[1],s=c.a.useState(""),o=Object(r.a)(s,2),l=o[0],u=o[1];return Object(p.jsxs)(v,{onSubmit:function(t){t.preventDefault(),e.onAddNewPlace({place:a,linkPlace:l}),i(""),u("")},name:"add",isOpen:e.isOpen,textTitle:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",textButton:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onClose:e.onClose,children:[Object(p.jsx)("input",{value:a,onChange:function(e){i(e.target.value)},id:"popup-add-title",className:"popup__input",name:"name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0}),Object(p.jsx)("span",{id:"popup-add-title-error",className:"popup__error"}),Object(p.jsx)("input",{value:l,onChange:function(e){u(e.target.value)},id:"popup-add-link",className:"popup__input",name:"link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(p.jsx)("span",{id:"popup-add-link-error",className:"popup__error"})]})};var y=function(){var e=c.a.useState({name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",about:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",avatar:g}),t=Object(r.a)(e,2),n=t[0],a=t[1],i=c.a.useState(!1),s=Object(r.a)(i,2),o=s[0],l=s[1],u=c.a.useState(!1),d=Object(r.a)(u,2),m=d[0],f=d[1],O=c.a.useState(!1),v=Object(r.a)(O,2),y=v[0],S=v[1],w=c.a.useState([]),D=Object(r.a)(w,2),P=D[0],T=D[1],E=c.a.useState({name:"",img:""}),L=Object(r.a)(E,2),A=L[0],R=L[1];function I(){l(!1),S(!1),f(!1),R({name:"",img:""})}return c.a.useEffect((function(){var e=function(e){"Escape"===e.key&&I()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),c.a.useEffect((function(){Promise.all([x.getCardsFromServer(),x.getUserInfo()]).then((function(e){var t=Object(r.a)(e,2),n=t[0],c=t[1];T(n),a(c)})).catch((function(e){console.log("1 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))}),[]),Object(p.jsxs)(h.Provider,{value:n,children:[Object(p.jsx)(b,{cards:P,onEditAvatar:function(){l(!0)},onEditProfile:function(){S(!0)},onAddPlace:function(){f(!0)},onCardClick:function(e){R({name:e.name,img:e.img})},onCardLike:function(e){var t;t=e.likes.some((function(e){return e._id===n._id}))?"DELETE":"PUT",x.changeLikeCardStatus(e.id,t).then((function(t){T((function(n){return n.map((function(n){return n._id===e.id?t:n}))}))})).catch((function(e){console.log("3 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))},onCardDelete:function(e){x.delCard(e.id).then((function(t){var n=P.filter((function(t){return t._id!==e.id}));T(n)})).catch((function(e){console.log("5 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))}}),Object(p.jsx)(N,{onUpdateAvarar:function(e){x.changeAvatar(e).then((function(e){a(e),I()})).catch((function(e){console.log("8 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))},isOpen:o,onClose:I}),Object(p.jsx)(k,{onUpdateUser:function(e){x.loadProfile(e).then((function(e){a(e),I()})).catch((function(e){console.log("7 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))},isOpen:y,onClose:I}),Object(p.jsx)(C,{onAddNewPlace:function(e){x.loadNewCard({name:e.place,link:e.linkPlace}).then((function(e){T([e].concat(Object(j.a)(P))),I()})).catch((function(e){console.log("6 \u041e\u0448\u0438\u0431\u043a\u0430 ===> ",e)}))},isOpen:m,onClose:I}),Object(p.jsx)(_,{card:A,onClose:I})]})};var S=function(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsxs)("p",{className:"footer__title",children:["\xa9 ",(new Date).getFullYear()," Mesto Russia"]})})};var w=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],i=n[1],s=c.a.useState(""),o=Object(r.a)(s,2),l=o[0],u=o[1];return Object(p.jsxs)("div",{className:"enter__container",children:[Object(p.jsx)("h1",{className:"enter__title",children:"\u0412\u0445\u043e\u0434"}),Object(p.jsxs)("form",{className:"enter__form",action:"index.html",method:"post",name:"login",onSubmit:function(t){t.preventDefault(),e.onLoginClick({identifier:a,password:l})},children:[Object(p.jsx)("input",{value:a,onChange:function(e){i(e.target.value)},className:"enter__input",name:"name",type:"text",placeholder:"Email",required:!0}),Object(p.jsx)("input",{value:l,onChange:function(e){u(e.target.value)},className:"enter__input",name:"about",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0}),Object(p.jsx)("button",{className:"enter__save",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})};var D=function(e){var t=c.a.useState(""),n=Object(r.a)(t,2),a=n[0],i=n[1],s=c.a.useState(""),o=Object(r.a)(s,2),l=o[0],u=o[1];return Object(p.jsxs)("div",{className:"enter__container",children:[Object(p.jsx)("h1",{className:"enter__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(p.jsxs)("form",{className:"enter__form",action:"index.html",method:"post",name:"reg",onSubmit:function(t){t.preventDefault(),e.onRegClick({identifier:a,password:l})},children:[Object(p.jsx)("input",{value:a,onChange:function(e){i(e.target.value)},className:"enter__input",name:"name",type:"text",placeholder:"Email",required:!0}),Object(p.jsx)("input",{value:l,onChange:function(e){u(e.target.value)},className:"enter__input",name:"about",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0}),Object(p.jsx)("button",{className:"enter__save",type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(p.jsxs)("div",{className:"enter__field",children:[Object(p.jsx)("h2",{className:"enter__subtitle",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(p.jsx)("a",{className:"enter__link",href:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},P=n.p+"static/media/enter_on.1b6082f8.svg",T=n.p+"static/media/enter_off.7c6a020b.svg";var E=function(e){return Object(p.jsx)("div",{className:e.isOpen?"popup popup_open":"popup",children:Object(p.jsxs)("div",{className:"popup__container",children:[Object(p.jsx)("button",{className:"popup__close",type:"button",onClick:e.onClose}),Object(p.jsx)("img",{className:"popup__img",src:e.res?P:T,alt:e.alt}),Object(p.jsx)("p",{className:"popup__subtitle",children:e.title})]})})},L=n(20),A=function(e){var t=function(){return e.component.props.children};return Object(p.jsx)(l.b,{children:function(){return!0===e.loggedIn?Object(p.jsx)(t,Object(L.a)({},e)):Object(p.jsx)(l.a,{to:"/sign-in"})}})},R="https://auth.nomoreparties.co";function I(e){return console.log("gRD status -> ",e.statusText),e.ok?e.json():Promise.reject("Auth-\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}var F=function(){var e=c.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],i=c.a.useState(!1),s=Object(r.a)(i,2),o=s[0],u=s[1],j=c.a.useState(""),h=Object(r.a)(j,2),m=h[0],b=h[1],_=c.a.useState("\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0449\u0435\u0435, \u0447\u0442\u043e \u0432\u0441\u0451 \u043f\u043b\u043e\u0445\u043e!"),f=Object(r.a)(_,2),O=f[0],x=f[1],g=c.a.useState(!0),v=Object(r.a)(g,2),k=v[0],N=v[1],C=c.a.useState(""),P=Object(r.a)(C,2),T=P[0],L=P[1],F=Object(l.g)();return c.a.useEffect((function(){!function(){var e=localStorage.getItem("jwt");e&&(t=e,fetch("".concat(R,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return I(e)}))).then((function(t){t.email?(a(!0),F.push("/")):e&&(L(t.data.email),a(!0),F.push("/"))})).catch((function(e){return console.log("MR-\u041e\u0448\u0438\u0431\u043a\u04302: ",e)}));var t}()}),[]),Object(p.jsx)("div",{className:"page",children:Object(p.jsxs)(l.d,{children:[Object(p.jsxs)(l.b,{path:"/sign-in",children:[Object(p.jsx)(d,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",link:"/sign-up"}),Object(p.jsx)(w,{onLoginClick:function(e){(function(e){return fetch("".concat(R,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e.password,email:e.identifier})}).then((function(e){return I(e)}))})(e).then((function(t){t.token&&(L(e.identifier),localStorage.setItem("jwt",t.token),a(!0),F.push("/"))})).catch((function(e){return console.log("MR-\u041e\u0448\u0438\u0431\u043a\u04301: ",e)}))}})]}),Object(p.jsxs)(l.b,{path:"/sign-up",children:[Object(p.jsx)(d,{title:"\u0412\u043e\u0439\u0442\u0438",link:"/sign-in"}),Object(p.jsx)(D,{onRegClick:function(e){(function(e){return fetch("".concat(R,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e.password,email:e.identifier})}).then((function(e){return I(e)}))})(e).then((function(e){N(!0),b("\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"),x("\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0449\u0435\u0435, \u0447\u0442\u043e \u0432\u0441\u0451 \u0445\u043e\u0440\u043e\u0448\u043e!"),u(!0)})).catch((function(e){N(!1),b("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."),x("\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0449\u0435\u0435, \u0447\u0442\u043e \u0432\u0441\u0451 \u043f\u043b\u043e\u0445\u043e!"),u(!0),console.log("MR-\u041e\u0448\u0438\u0431\u043a\u04303: ",e)}))}}),Object(p.jsx)(E,{isOpen:o,title:m,alt:O,res:k,onClose:function(){u(!1)}})]}),Object(p.jsx)(A,{path:"/",loggedIn:n,component:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(d,{email:T,onSignOut:function(){localStorage.removeItem("jwt"),a(!1),F.push("/sign-in")}}),Object(p.jsx)(y,{}),Object(p.jsx)(S,{})]})}),Object(p.jsx)(l.b,{children:n?Object(p.jsx)(l.a,{to:"/"}):Object(p.jsx)(l.a,{to:"/sign-in"})})]})})},q=n(6);s.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(q.a,{children:Object(p.jsx)("div",{className:"page",children:Object(p.jsx)(F,{})})})}),document.getElementById("root")),o()}},[[35,1,2]]]);
//# sourceMappingURL=main.b06125af.chunk.js.map